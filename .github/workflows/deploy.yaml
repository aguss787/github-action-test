name: Deploy

on:
  workflow_dispatch:
    inputs:
      commit_id:
        description: 'Commit id to be deployed'
        required: false
        default: 'main'
      env:
        description: 'env'
        required: true
        default: 'production' # todo: dropdown

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    environment: 
      name: ${{ github.event.inputs.env }}
    steps:
      - name: Check out
        uses: actions/checkout@v2
        with:
          ref: ${{ github.event.inputs.commit_id }}
          fetch-depth: 0
          token: "${{ secrets.GITHUB_TOKEN }}"
      - name: Deploy
        run: |
          echo deploying
          git log --no-walk --tags --pretty="%h %d %s" --decorate=full -n 10 > logs
          cat logs
          head CHANGELOG.md -n 100
